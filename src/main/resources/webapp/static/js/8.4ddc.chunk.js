(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{619:function(e,t,n){var r=n(621),a=n(622),c=n(623);e.exports=function(e,t){return r(e)||a(e,t)||c()}},621:function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},622:function(e,t){e.exports=function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],r=!0,a=!1,c=void 0;try{for(var o,i=e[Symbol.iterator]();!(r=(o=i.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(l){a=!0,c=l}finally{try{r||null==i.return||i.return()}finally{if(a)throw c}}return n}}},623:function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},795:function(e,t,n){"use strict";n.r(t);var r=n(9),a=n.n(r),c=n(29),o=n.n(c),i=n(638),l=n(698),s=n(703),u=n(700),d=n(701),f=n(640),m=n(639),h=n(4),p=n(284),b=n(1),g=n.n(b),v=n(127),x=n(183),C=Object(p.a)((function(){var e=Object(x.g)(),t=Object(x.e)(),n=Object(x.f)(),r=Object(b.useCallback)(function(){var t=o()(a.a.mark((function t(r){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.sendChatMsg(e.currentContact.id,1,r),t.abrupt("return",!0);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),[]),c=e.currentContact&&n.otherIdToRoom.has(e.currentContact.id)?n.otherIdToRoom.get(e.currentContact.id).roomKey:void 0,i=e.currentContact&&c&&n.roomKeyToMessageList.has(c)?n.roomKeyToMessageList.get(c).slice():[],m=Object(p.b)({hasMore:!0,fetching:!1}),v=Object(b.useCallback)(o()(a.a.mark((function t(){var r,c;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.currentContact||m.fetching||!m.hasMore){t.next=11;break}if(m.fetching=!0,r=n.otherIdToRoom.get(e.currentContact.id)){t.next=7;break}return t.next=6,n.fetchRoomInfo(1,e.currentContact.id);case 6:r=t.sent;case 7:return t.next=9,n.nextMessagePage(r.roomKey);case 9:c=t.sent,Object(h.i)((function(){m.fetching=!1,m.hasMore=c}));case 11:case"end":return t.stop()}}),t)}))),[]);Object(u.a)(e,n),Object(b.useEffect)((function(){m.fetching=!1,m.hasMore=!0,v(),t.emit("changeContact")}),[e.currentContact]);var C={on:function(e){var r=function(t){t.roomKey===c&&e()};n.bus.addListener("remind",r);var a=function(){e()};return t.addListener("changeContact",a),function(){t.removeListener("changeContact",a),n.bus.removeListener("remind",r)}}},j=Object(b.useCallback)(o()(a.a.mark((function t(){var r,c,o;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.config.upload){t.next=12;break}return t.next=3,Object(d.a)((function(e){e.accept="image/*",e.multiple=!1}));case 3:if(!((r=t.sent).length>0)){t.next=10;break}return t.next=7,e.config.upload(r[0]);case 7:c=t.sent,o='\n          <div>\n            <img src="'.concat(c,'"/>\n          </div>\n        '),n.sendChatMsg(e.currentContact.id,1,o);case 10:t.next=13;break;case 12:f.a.error("The upload image function is not implemented.\nPlease implement it and provided as config. ");case 13:case"end":return t.stop()}}),t)}))),[]);return g.a.createElement(y,null,g.a.createElement("div",null,g.a.createElement(k,null)),g.a.createElement("div",null,g.a.createElement("div",null,g.a.createElement("div",null,g.a.createElement(s.a,{me:n.me||{},messageList:i.slice(),other:e.currentContact||{},canRefresh:function(e){v()},goBottomListener:C})),g.a.createElement("div",null,g.a.createElement(l.a,{onSend:r,onClickImageBtn:j})))),e.currentContact?null:g.a.createElement(w,null,g.a.createElement("span",null,"\u8bf7\u9009\u62e9\u5ba2\u670d")))})),y=v.a.div.withConfig({displayName:"ChatPanel___ChatPanel",componentId:"sc-3f5mk3-0"})(["position:relative;overflow:hidden;display:flex;flex-direction:column;height:100%;width:100%;> div:nth-child(1){height:60px;}> div:nth-child(2){flex:1;display:flex;> div:nth-child(1){flex:2;display:flex;flex-direction:column;> div:nth-child(1){flex:1;}> div:nth-child(2){border-top:solid 1px #dcdcdc;}}}"]),w=v.a.div.withConfig({displayName:"ChatPanel___UnselectModal",componentId:"sc-3f5mk3-1"})(["position:absolute;z-index:1;top:0;left:0;width:100%;height:100%;display:flex;justify-content:center;align-items:center;background-color:rgba(0,0,0,0.2);> span{font-size:2em;}"]),k=Object(p.a)((function(){var e=Object(x.g)(),t=e.currentContact?e.currentContact:{};return g.a.createElement(j,null,g.a.createElement("div",null,g.a.createElement(i.a,{src:t.avatar,height:40,width:40})),g.a.createElement("div",null,g.a.createElement("span",null,t.nickName)))})),j=v.a.div.withConfig({displayName:"ChatPanel___Title",componentId:"sc-3f5mk3-2"})(["display:flex;padding:1rem;background-color:",";border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:",";> div:nth-child(1){}> div:nth-child(2){flex:1;display:flex;flex-direction:column;margin-left:1rem;> span:nth-child(1){font-size:1rem;}}"],m.a.WhiteSmoke,m.a.Gainsboro);t.default=C}}]);